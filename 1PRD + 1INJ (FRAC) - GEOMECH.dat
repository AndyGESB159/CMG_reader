
*****************************************************************************
** Template  (stfrr002.dat): Geothermal Reservoir Modelling with MINC      **
*****************************************************************************
**************************************************************************************

**  ==============  INPUT/OUTPUT CONTROL  ======================

RESULTS SIMULATOR STARS

*INTERRUPT *STOP

*TITLE1 'STARS Test Bed No. 29'
*TITLE2 'Pruess Geothermal Problem (1/8 of a Five-Spot, One Component)'
*TITLE3 'Natural Fractures Modelled with the MINC Option'

*CASEID 'RUN1'

*INUNIT  *SI
*OUTUNIT *SI

*OUTPRN *GRID *PRES *SW *SG *TEMP *MOLDENG *MOLDENW
*OUTPRN *WELL *ALL
*OUTPRN *ITER *NEWTON
SRFORMAT *SR3_IMRF

*WPRN *ITER 300
*WPRN *GRID 300
OUTSRF GRID PRES SG SO SW TEMP 
OUTSRF WELL  PHWELL
*WRST 20

*OUTSRF *SPECIAL BLOCKVAR TEMP 15,10,1
*OUTSRF *SPECIAL BLOCKVAR TEMP 15,10,2
*OUTSRF *SPECIAL BLOCKVAR TEMP 15,10,3
*OUTSRF *SPECIAL BLOCKVAR TEMP 15,10,4
*OUTSRF *SPECIAL BLOCKVAR TEMP 15,10,5

**  ==============  GRID AND RESERVOIR DEFINITION  =================


*GRID *CART 30 20 5

KDIR DOWN
*DI *CON 100 ** CON means uniform in the I-direction
*DJ *CON 100 ** CON means uniform in the J-direction
*DK *CON 30 ** CON means uniform in the K-direction
*DTOP 600*2000

DUALPERM

NULL *MATRIX CON            1
NULL *FRACTURE CON            1

** The whole reservoir is fractured, and element size is 50 m in all directions
*DIFRAC *CON 5
DJFRAC  EQUALSI
DKFRAC  EQUALSI

*POR *MATRIX   *CON 0.2
*POR *FRACTURE *CON 0.01

*PERMI *MATRIX   *CON 10
*PERMI *FRACTURE *CON 100
  MOD   1  1:20  1:5   =  1000
       1:30  10  1:5   =  1000

*PERMJ *MATRIX   *CON 10
*PERMJ *FRACTURE *CON 100
  MOD   1  1:20  1:5   =  1000
       1:30  10  1:5   =  1000

*PERMK *MATRIX   *CON 10
*PERMK *FRACTURE *CON 100
  MOD   1  1:20  1:5   =  1000
       1:30  10  1:5   =  1000
**  0 = pinched block, 1 = active block
PINCHOUTARRAY CON            1

*END-GRID

ROCKTYPE 1

** Intrinsic rock/matrix properties
*CPOR 4.4E-7 ** formation compressibility
*ROCKCP 2.65E6 ** rock heat capacity
*THCONR 1.929E5 ** rock thermal conductivity
*THCONW 53500 ** water thermal conductivity
*THCONO 1.496E5 ** oil thermal conductivity
*THCONG 4000 ** gas thermal conductivity
*CTPOR 7.95E-6

** Fracture rock type for geomechanics
*ROCKTYPE 2 COPY 1
*CPOR 4.4E-7 ** formation compressibility
*ROCKCP 2.65E6 ** rock heat capacity
*THCONR 1.929E5 ** rock thermal conductivity
*THCONW 53500 ** water thermal conductivity
*THCONO 1.496E5 ** oil thermal conductivity
*THCONG 4000 ** gas thermal conductivity
*CTPOR 7.95E-6

**HLOSSPROP *OVERBUR 2.683E6 1.047E6 ** heat loss properties (oberburden)
**          *UNDERBUR 2.683E6 1.047E6 ** heat loss properties (underburden)

*THTYPE *MATRIX   *CON 1
*THTYPE *FRACTURE *CON 2

**  ==============  FLUID DEFINITIONS  ======================


*MODEL 1 1 1                        ** Water component only

*COMPNAME           'WATER'
**                ---------

*CMM                0.01802 ** molecular weight
*MOLDEN              55500 ** molar density
*CP                  4.5E-7 ** compressibility
*CT1                 8.8E-4 ** firast coefficient of thermal expansion correlation
*TCRIT               647.35 ** critical temperature
*IDEALGAS ** use ideal gas law for gas phase density
*CPL1                  0 ** first coeff in liquid phase heat capacity correlation
*CPG1                  0 ** first coeff in gas phase heat capacity correlation
*AVISC                 0 ** use avisc defaults for viscosity




**  ==============  ROCK-FLUID PROPERTIES  ======================


*ROCKFLUID

*RPT 1    **  -----------  MATRIX  ------------ rock type number for rock-fluid data

*SWT   **  Water-oil relative permeabilities

**   Sw         Krw          Krow
**  ----      --------      ------
    0.30       0.0           1.0
    0.35      0.0043        0.0928
    0.40      0.005672      0.0857
    0.45      0.01898       0.0786
    0.50      0.0334        0.0714
    0.60      0.0845        0.0571
    0.70      0.1815        0.0428
    0.80      0.3462        0.0286
    0.85      0.4627        0.0214
    0.90      0.6074        0.0143
    0.95      0.7849        0.0071
    1.0       1.0           0.0

*SLT   **  Liquid-gas relative permeabilities

**   Sl         Krg          Krog
**  ----      -------       ------
    0.30       1.0           0.0
    0.35      0.852         0.071
    0.40      0.716         0.143
    0.45      0.592         0.214
    0.50      0.479         0.286
    0.60      0.29          0.428
    0.70      0.148         0.571
    0.80      0.0532        0.714
    0.85      0.0237        0.786
    0.90      0.00592       0.857
    0.95       0.0          0.928
    1.0        0.0           1.0

*KRTYPE *MATRIX *CON 1

*RPT 2    **  -----------  FRACTURE  ------------

*SWT   **  Water-oil relative permeabilities

**   Sw        Krw         Krow
**  ----      ------      ------
    0.0        0.0         1.0
    1.0        1.0         0.0

*SLT   **  Liquid-gas relative permeabilities

**   Sl        Krg         Krog
**  ----      ------      ------
    0.0        1.0         0.0
    1.0        0.0         1.0

*KRTYPE *FRACTURE *CON 2



**  ==============  INITIAL CONDITIONS  ======================


*INITIAL ** flags the beginning of initial conditions
*VERTICAL *DEPTH_AVE *EQUIL

INITREGION 1
REFDEPTH 2000
*REFPRES 23000


**PRES *MATRIX   *CON 8577 ** initial pressure in matrix
**PRES *FRACTURE *CON 8577 ** initial pressure in fracture

*SW *MATRIX   *CON 1.0 ** initial water saturation in matrix
*SW *FRACTURE *CON 1.0 ** initial water saturation in fracture

*SO *MATRIX   *CON 0 ** initial oil saturation in matrix
*SO *FRACTURE *CON 0 ** initial oil saturation in fracture

*TEMP *MATRIX   *CON 200 ** initial temperature in matrix
*TEMP *FRACTURE *CON 200 ** initial temperature in fracture



**  ==============  NUMERICAL CONTROL  ======================


*NUMERICAL
*SDEGREE *GAUSS
*UPSTREAM *KLEVEL

*RANGECHECK *OFF
NORM PRESS 300 SATUR 0.4 TEMP 200 Y 0.4 X 0.4
*RANGECHECK *ON


**  ==============  GEOMECH  ======================

*GEOMECH                   ** geomechanics main keyword

*GEOM3D                    ** 3D FE
*GCOUPLING 2               ** Coupling option # 2
*CALIB_POR                 ** Porosity calibration
*GCFACTOR 1.0              ** Based on constrained boundaries
*GPTOLMUL 0.1              ** Tolerance for pressure in coupling option 2
**DISPLACTOL 1.5E-3           ** Displacement tolerance
**FORCETOL 1E0              ** Force tolerance

*SOLVERG *PCG
*PCG-SCALE *BLOCK-DIAGONAL    ** Default
*PCG-PCOND *ON                ** Default

** In this example, GEOGRID has the same size as that of the reservoir.
** However, in the GEOGRID along the J direction, the number of grids is 37 instead of 25.
** This is because some reservoir grids are refined (1:4). When this option (*GAMALJ) is used,
** GEOGRID is automatically generated and its number of grids (16x37x9) is different from
** the number of reservoir grids (16x25x9).

**GAMALJ  37  GVAR  3:3  1:4  5:5  1:4  5:5  1:4  5:5  1:4  3:3

*GEOROCK 1
*ELASTMOD 35.0e6            ** Young's modulus
*POISSRATIO .35            ** Poisson's ratio
*COHESION 690000000        ** Cohesion  - The value is large for elastic model
*THEXPCOEF  3.84E-5        ** Linear thermal expansion coefficient of matrix rock

*GJRC 10                   ** Roughness coefficient for fracture permeability
*GCRITICAL TENFRAC 9000    ** Tensile fracture criterion
*GPERMAX  1E6

*GEOROCK 2
*ELASTMOD 35.0e6            ** Young's modulus
*POISSRATIO .35            ** Poisson's ratio
*COHESION 690000000        ** Cohesion  - The value is large for elastic model
*THEXPCOEF  3.84E-5        ** Linear thermal expansion coefficient of matrix rock

*GJRC 10                   ** Roughness coefficient for fracture permeability
*GCRITICAL TENFRAC 9000    ** Tensile fracture criterion
*GPERMAX  1E6

*STRESS3D 2000 2000 4000 0.0 0.0 0.0
*STRESSGRAD3D -0.4628 -0.4628 -0.9256 0.0 0.0 0.0




*HYDROFRAC   *IJK

     1  1:20  1:5   03
     1:30  10  1:5  03

*GEOTYPE  *MATRIX    *CON   1
*GEOTYPE  *FRACTURE  *CON   2
 
**MAGNIFYDI  5E3        ** Magnify the deformation in I direction
*MAGNIFYDJ  5E2        ** Magnify the deformation in J direction
**MAGNIFYDK  5E3        ** Magnify the deformation in K direction

** ***************************************************************************
** Definition of fundamental cartesian grid
** ***************************************************************************
GEOGRID GCART 30 20 5
GDI GIVAR 
 30*100
GDJ GJVAR 
 20*100
GDK GKVAR 
 5*30


GCOUPLING 0
GOUTSRF GGRID DISPLRAD DISPLTAN SUBSIDGEO TEMP THCOMPR TSUBSIDGEO VDISPL VERDSPLGEO YIELD YLDSTATE YOUNG 


*RUN



**  ==============  RECURRENT DATA  ======================


*DATE 2022 01 01
   *DTWELL 1


WELL  'PRD-1'
PRODUCER 'PRD-1'
OPERATE  MAX  STW  10000.0  CONT REPEAT
**          rad  geofac  wfrac  skin
GEOMETRY  K  0.24  0.249  1.0  0.0  
      PERF       GEO  'PRD-1'
** UBA               ff          Status  Connection  
    15 10 1         1.0  OPEN  FLOW-TO  'SURFACE'  REFLAYER
    15 10 2         1.0  OPEN    FLOW-TO  1
    15 10 3         1.0  OPEN    FLOW-TO  2
    15 10 4         1.0  OPEN    FLOW-TO  3
    15 10 5         1.0  OPEN    FLOW-TO  4

WELL  'INJ-1'
INJECTOR UNWEIGHT 'INJ-1'
INCOMP  WATER  1.0
TINJW  25.0
PINJW  10000.0
OPERATE  MAX  STW  10000.0  CONT
**OPERATE  MAX  BHP  70000.0  CONT
**          rad  geofac  wfrac  skin
GEOMETRY  K  0.24  0.249  1.0  0.0  
      PERF       GEO  'INJ-1'
** UBA             ff          Status  Connection  
    1 1 1         1.0  OPEN    FLOW-FROM  'SURFACE'  REFLAYER
    1 1 2         1.0  OPEN    FLOW-FROM  1
    1 1 3         1.0  OPEN    FLOW-FROM  2
    1 1 4         1.0  OPEN    FLOW-FROM  3
    1 1 5         1.0  OPEN    FLOW-FROM  4


*DATE 2023 01 01
*DATE 2024 01 01
*DATE 2025 01 01
*DATE 2026 01 01
*DATE 2027 01 01
*DATE 2028 01 01
*DATE 2029 01 01
*DATE 2030 01 01
*DATE 2031 01 01
*DATE 2032 01 01
*DATE 2033 01 01
*DATE 2034 01 01
*DATE 2035 01 01
*DATE 2036 01 01
*DATE 2037 01 01
*DATE 2038 01 01
*DATE 2039 01 01
*DATE 2040 01 01
*DATE 2041 01 01
*DATE 2042 01 01
*DATE 2043 01 01
*DATE 2044 01 01
*DATE 2045 01 01
*DATE 2046 01 01
*DATE 2047 01 01
*DATE 2048 01 01
*DATE 2049 01 01
*DATE 2050 01 01
*DATE 2051 01 01
*DATE 2052 01 01

*STOP

RESULTS SPEC 'Fracture Spacing J'  
RESULTS SPEC SPECNOTCALCVAL -99999      
RESULTS SPEC REGION 'All Layers (Whole Grid)'
RESULTS SPEC REGIONTYPE 'REGION_WHOLEGRID'
RESULTS SPEC LAYERNUMB 0
RESULTS SPEC PORTYPE 1
RESULTS SPEC EQUALSI 0 1           
RESULTS SPEC SPECKEEPMOD 'YES'
RESULTS SPEC STOP


RESULTS SPEC 'Fracture Spacing K'  
RESULTS SPEC SPECNOTCALCVAL -99999      
RESULTS SPEC REGION 'All Layers (Whole Grid)'
RESULTS SPEC REGIONTYPE 'REGION_WHOLEGRID'
RESULTS SPEC LAYERNUMB 0
RESULTS SPEC PORTYPE 1
RESULTS SPEC EQUALSI 0 1           
RESULTS SPEC SPECKEEPMOD 'YES'
RESULTS SPEC STOP

